---
title: "Analise Dados"
output: html_notebook
---

```{r}
load('../cache/data_seed.RData')
library(plyr)
library(dplyr)
library(lattice)
```

## Resumo dos dados

Dados extraidos dos Google Anlytics do site Seed-MG

```{r}
print(summary(data_seed$sessions))
```


```{r}
data_seed$sessions %>% 
  dplyr::filter(sessions <= 10) %>% 
  lattice::histogram(~users, data = ., breaks = 16)
```

```{r}
data_seed$sessions %>% 
  dplyr::filter(sessions <= 10) %>%
  lattice::xyplot(sessions ~ date, data = ., type = 'l')
```
```{r}
data_seed$sessions %>% 
  dplyr::filter(sessions <= 10) %>%
  dplyr::group_by(date) %>% 
  dplyr::summarise(mean = mean(sessions)) %>% 
  lattice::xyplot(mean ~ date, data = ., type = 'l')
```

```{r}
data_seed$sessions %>% 
  dplyr::group_by(date) %>% 
  dplyr::summarise(mean = mean(users)) %>% 
  lattice::xyplot(mean ~ date, data = ., type = 'l')
```
```{r}
data_seed$sessions %>% 
  dplyr::filter(grepl('minas gerais|sao paulo|rio de janeiro', region, TRUE)) %>% 
  dplyr::group_by(date, region) %>% 
  dplyr::summarise(total = sum(users)) %>% 
  dplyr::mutate(ltotal = log10(total)) %>% 
  lattice::xyplot(ltotal ~ date, data = ., type = 'l', groups = region, auto.key = TRUE)
```

```{r}
data_seed$sessions %>% 
  dplyr::group_by(region) %>% 
  dplyr::summarise(total = sum(users)) %>% 
  dplyr::arrange(dplyr::desc(total)) %>% 
  print()
```
```{r}
data_seed$sessions %>% 
  dplyr::filter(grepl('minas gerais|sao paulo|rio de janeiro|parana|santa catarina|rio grande do sul', region, TRUE)) %>% 
  dplyr::group_by(date, region) %>% 
  dplyr::summarise(total = sum(users)) %>% 
  dplyr::mutate(ltotal = log10(total)) %>% 
  lattice::xyplot(ltotal ~ date, data = ., type = 'l', groups = region)
```


```{r}
print(head(data_seed$sessions))
```

